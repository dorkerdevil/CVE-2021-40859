import sys
import requests
import logging
logging.basicConfig(level=logging.DEBUG)

target_in = sys.argv[1]

product = ['COMpact 4000', 'COMpact 5000(R)', 'COMpact 5200(R)', 'COMpact 5500R', 'COMmander 6000(R)(RX))', 'COMpact 3000 ISDN', 'COMpact 3000 analog', 'COMpact 3000 VoIP']

response = requests.get(target_in+'/about_state',verify=False,timeout=3)
tmp = response.json()
Schandelah = tmp['pbx'],tmp['version']
for i in product:
    if i in Schandelah:   
        print("\033[1;31m"+'''Auerswald COMpact Device Found - Product Name and Version+Build ->'''+"\033[0m", Schandelah)
        print("\033[1;31m"+'''Most Likely the target is Vulnerable , Please confirm with the exploit avilable here -> https://github.com/dorkerdevil/CVE-2021-40859/blob/main/CVE-2021-40859.py '''+"\033[0m")
